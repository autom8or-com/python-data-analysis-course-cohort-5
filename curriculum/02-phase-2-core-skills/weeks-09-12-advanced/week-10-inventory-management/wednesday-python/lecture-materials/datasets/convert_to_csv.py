"""
Week 10 - Inventory Management Data Export
This script converts JSON data from Supabase to CSV files for pandas exercises
"""

import pandas as pd
import json
from io import StringIO

# Product data (100 products with categories and dimensions)
products_json = """[{"product_id":"1e9e8ef04dbcff4541ed26657ea517e5","product_category_name":"perfumaria","category":"perfumery","weight_grams":225,"length_cm":16,"height_cm":10,"width_cm":14,"volume_cm3":2240},{"product_id":"3aa071139cb16b67ca9e5dea641aaa2f","product_category_name":"artes","category":"art","weight_grams":1000,"length_cm":30,"height_cm":18,"width_cm":20,"volume_cm3":10800},{"product_id":"96bd76ec8810374ed1b65e291975717f","product_category_name":"esporte_lazer","category":"sports_leisure","weight_grams":154,"length_cm":18,"height_cm":9,"width_cm":15,"volume_cm3":2430},{"product_id":"cef67bcfe19066a932b7673e239eb23d","product_category_name":"bebes","category":"baby","weight_grams":371,"length_cm":26,"height_cm":4,"width_cm":26,"volume_cm3":2704},{"product_id":"9dc1a7de274444849c219cff195d0b71","product_category_name":"utilidades_domesticas","category":"housewares","weight_grams":625,"length_cm":20,"height_cm":17,"width_cm":13,"volume_cm3":4420},{"product_id":"41d3672d4792049fa1779bb35283ed13","product_category_name":"instrumentos_musicais","category":"musical_instruments","weight_grams":200,"length_cm":38,"height_cm":5,"width_cm":11,"volume_cm3":2090},{"product_id":"732bd381ad09e530fe0a5f457d81becb","product_category_name":"cool_stuff","category":"cool_stuff","weight_grams":18350,"length_cm":70,"height_cm":24,"width_cm":44,"volume_cm3":73920},{"product_id":"2548af3e6e77a690cf3eb6368e9ab61e","product_category_name":"moveis_decoracao","category":"furniture_decor","weight_grams":900,"length_cm":40,"height_cm":8,"width_cm":40,"volume_cm3":12800},{"product_id":"37cc742be07708b53a98702e77a21a02","product_category_name":"eletrodomesticos","category":"home_appliances","weight_grams":400,"length_cm":27,"height_cm":13,"width_cm":17,"volume_cm3":5967},{"product_id":"8c92109888e8cdf9d66dc7e463025574","product_category_name":"brinquedos","category":"toys","weight_grams":600,"length_cm":17,"height_cm":10,"width_cm":12,"volume_cm3":2040},{"product_id":"14aa47b7fe5c25522b47b4b29c98dcb9","product_category_name":"cama_mesa_banho","category":"bed_bath_table","weight_grams":1100,"length_cm":16,"height_cm":10,"width_cm":16,"volume_cm3":2560},{"product_id":"03b63c5fc16691530586ae020c345514","product_category_name":"bebes","category":"baby","weight_grams":7150,"length_cm":50,"height_cm":19,"width_cm":45,"volume_cm3":42750},{"product_id":"cf55509ea8edaaac1d28fdb16e48fc22","product_category_name":"instrumentos_musicais","category":"musical_instruments","weight_grams":250,"length_cm":17,"height_cm":7,"width_cm":17,"volume_cm3":2023},{"product_id":"7bb6f29c2be57716194f96496660c7c2","product_category_name":"moveis_decoracao","category":"furniture_decor","weight_grams":600,"length_cm":68,"height_cm":11,"width_cm":13,"volume_cm3":9724},{"product_id":"eb31436580a610f202c859463d8c7415","product_category_name":"construcao_ferramentas_seguranca","category":"construction_tools_safety","weight_grams":200,"length_cm":17,"height_cm":7,"width_cm":17,"volume_cm3":2023},{"product_id":"3bb7f144022e6732727d8d838a7b13b3","product_category_name":"esporte_lazer","category":"sports_leisure","weight_grams":800,"length_cm":16,"height_cm":2,"width_cm":11,"volume_cm3":352},{"product_id":"6a2fb4dd53d2cdb88e0432f1284a004c","product_category_name":"perfumaria","category":"perfumery","weight_grams":400,"length_cm":27,"height_cm":5,"width_cm":20,"volume_cm3":2700},{"product_id":"a1b71017a84f92fd8da4aeefba108a24","product_category_name":"informatica_acessorios","category":"computers_accessories","weight_grams":900,"length_cm":40,"height_cm":15,"width_cm":20,"volume_cm3":12000},{"product_id":"a0736b92e52f6cead290e30b578413b6","product_category_name":"moveis_decoracao","category":"furniture_decor","weight_grams":1700,"length_cm":100,"height_cm":7,"width_cm":15,"volume_cm3":10500},{"product_id":"f53103a77d9cf245e579ea37e5ec51f0","product_category_name":"cama_mesa_banho","category":"bed_bath_table","weight_grams":500,"length_cm":16,"height_cm":10,"width_cm":16,"volume_cm3":2560}]"""

# Convert and save products
products_df = pd.read_json(StringIO(products_json))
products_df.to_csv('products.csv', index=False)
print(f"[OK] Created products.csv ({len(products_df)} rows)")

# Orders data (100 recent orders)
orders_json = """[{"order_id":"54282e97f61c23b78330c15b154c867d","customer_id":"4b7decb9b58e2569548b8b4c8e20e8d7","order_status":"shipped","order_date":"2018-09-03","delivery_date":null},{"order_id":"35a972d7f8436f405b56e36add1a7140","customer_id":"898b7fee99c4e42170ab69ba59be0a8b","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"03ef5dedbe7492bdae72eec50764c43f","customer_id":"496630b6740bcca28fce9ba50d8a26ef","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"168626408cb32af0ffaf76711caae1dc","customer_id":"6e353700bc7bcdf6ebc15d6de16d7002","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"0b223d92c27432930dfe407c6aea3041","customer_id":"e60df9449653a95af4549bbfcb18a6eb","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"52018484704db3661b98ce838612b507","customer_id":"e450a297a7bc6839ceb0cf1a2377fa02","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"d03ca98f59480e7e76c71fa83ecd8fb6","customer_id":"56b1ac2855cc6d7950b4ffa6a9b41b0d","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"d70442bc5e3cb7438da497cc6a210f80","customer_id":"10a79ef2783cae3d8d678e85fde235ac","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"912859fef5a0bd5059b6d48fa79d121a","customer_id":"b8c19e70d00f6927388e4f31c923d785","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"fb393211459aac00af932cd7ab4fa2cc","customer_id":"54365416b7ef5599f54a6c7821d5d290","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"bee12e8653a04e76786e8891cfb6330a","customer_id":"448945bc713d98b6726e82eda6249b9e","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"c84d88553f9878bf2c7ecda2eb211ece","customer_id":"c4c66f47534e09a03fc7a878a9eda5ea","order_status":"delivered","order_date":"2018-08-29","delivery_date":"2018-08-30"},{"order_id":"4c867c2aac81653679eff07e922441a0","customer_id":"8ffe52ac7d480a27180338e697eec534","order_status":"delivered","order_date":"2018-08-28","delivery_date":"2018-08-31"},{"order_id":"e7c290bfc31d7eed478c3d3d2d4d2953","customer_id":"004440537b68545ca3c341d7279bc4c0","order_status":"delivered","order_date":"2018-08-28","delivery_date":"2018-08-30"},{"order_id":"dbb786f88b6d4e52fe3cb5d771b979d6","customer_id":"478778636c75019554439f75286a22e3","order_status":"delivered","order_date":"2018-08-28","delivery_date":"2018-08-30"},{"order_id":"3064071cf67a2cc381cd53b13055eac5","customer_id":"931bfab7036f6763dc1bdf6e2696e08b","order_status":"delivered","order_date":"2018-08-28","delivery_date":"2018-08-30"},{"order_id":"00b44ba3d7c4a5e9a9ebafef9150781d","customer_id":"0b5f6687d659478f1747caed607c4ec5","order_status":"delivered","order_date":"2018-08-28","delivery_date":"2018-08-30"},{"order_id":"cb9628da43a976b479b45230984a05b8","customer_id":"c5c43d14a781c58ed1fdac7c9652f18f","order_status":"delivered","order_date":"2018-08-28","delivery_date":"2018-08-30"},{"order_id":"bda15d43b16684fa4eff328a7db33d8b","customer_id":"6eff0b0388f0e0829bd659d12e168828","order_status":"delivered","order_date":"2018-08-28","delivery_date":"2018-08-30"},{"order_id":"d99a07d049ac5c39f6f62edba8d57721","customer_id":"f5fc6bc27d5c599cc9bed0a2eacf030e","order_status":"delivered","order_date":"2018-08-28","delivery_date":"2018-08-30"}]"""

orders_df = pd.read_json(StringIO(orders_json))
orders_df.to_csv('orders.csv', index=False)
print(f"[OK] Created orders.csv ({len(orders_df)} rows)")

# Order items data
order_items_json = """[{"order_id":"00b44ba3d7c4a5e9a9ebafef9150781d","order_item_id":1,"product_id":"d9a5a5120d4d357871acd5408cb10e18","seller_id":"20d83f3ef0e6925fd74bfd59170babf7","price":59.9,"freight_value":7.68},{"order_id":"00eead1d5a799277ef3d6b387b0bebef","order_item_id":1,"product_id":"2bd9b51a9ab079e095aca987845d3266","seller_id":"81f89e42267213cb94da7ddc301651da","price":85,"freight_value":13.26},{"order_id":"03ef5dedbe7492bdae72eec50764c43f","order_item_id":1,"product_id":"c7f27c5bef2338541c772b5776403e6a","seller_id":"7d7866a99a8656a42c7ff6352a433410","price":24.9,"freight_value":8.33},{"order_id":"056793ca2483a5d5943cb5bd90f5b314","order_item_id":1,"product_id":"cc419cef76963f8e0cde78157908a6c3","seller_id":"fadb07c842a2aef5d5a676b85f220e71","price":21.99,"freight_value":17.47},{"order_id":"05d46826bd0fb605d6b00e30e9141882","order_item_id":1,"product_id":"e84d1a4a08db13e8dea6d400a1c6a3f0","seller_id":"7f40d06aa0b5f1aa4f41af8c0480e2ef","price":49.99,"freight_value":11.37},{"order_id":"06914a88cb181e922cc58fed3d198c98","order_item_id":1,"product_id":"dce7d5964fd84b401af7d9369a9df643","seller_id":"6eeed17989b0ae47c9f11ece6f38ea90","price":159,"freight_value":16.41},{"order_id":"0785459f4688c430590e9ef6eff2fecb","order_item_id":1,"product_id":"86ecc269de40ba13205e7beeee12f26f","seller_id":"b76dba6c951ab00dc4edf0a1aa88037e","price":29.99,"freight_value":7.47},{"order_id":"0ac69790e2a6e4c075edbd78648a3594","order_item_id":1,"product_id":"3f0602cdcad0ac24d72b038103a3783e","seller_id":"5def4c3732941a971cba8fdee992ede1","price":7.5,"freight_value":7.39},{"order_id":"0b223d92c27432930dfe407c6aea3041","order_item_id":1,"product_id":"2b4472df15512a2825ae86fd9ae79335","seller_id":"67bf6941ba2f1fa1d02c375766bc3e53","price":209,"freight_value":46.48},{"order_id":"0b223d92c27432930dfe407c6aea3041","order_item_id":2,"product_id":"2b4472df15512a2825ae86fd9ae79335","seller_id":"67bf6941ba2f1fa1d02c375766bc3e53","price":209,"freight_value":46.48},{"order_id":"0c1f1a0595fb30e05d526ab83576cd24","order_item_id":1,"product_id":"a59fb60fddcc72a9878b7ed5cb69d8e4","seller_id":"7040e82f899a04d1b434b795a43b4617","price":14.9,"freight_value":7.39},{"order_id":"141d7ee98d9a50269f84d9a3c5330cba","order_item_id":1,"product_id":"37f4d0bf85fbf875c920d460766d6a5c","seller_id":"955fee9216a65b617aa5c0531780ce60","price":30,"freight_value":8.37},{"order_id":"168626408cb32af0ffaf76711caae1dc","order_item_id":1,"product_id":"bdcf6a834e8faa30dac3886c7a58e92e","seller_id":"2a84855fd20af891be03bc5924d2b453","price":45.9,"freight_value":15.39},{"order_id":"1776f9cc0f976e7aa0e8372a5325c41a","order_item_id":1,"product_id":"49d23d4887468040921b413a6d4f3ec7","seller_id":"8a432f4e5b471f8da497d7dc517666e2","price":69,"freight_value":13.14},{"order_id":"18995da0f41134f344ebeb2e97965d2d","order_item_id":1,"product_id":"a9d28bf666feccc924dd16f0a19cb70b","seller_id":"33ab10be054370c254ddfcf0a6253422","price":58.2,"freight_value":7.83},{"order_id":"20db59f6705840a0ce5c76b77487ad03","order_item_id":1,"product_id":"9799f204443f39b914cb108eb13ef6e2","seller_id":"55dedd83e501d8248880557d9073cbfd","price":84.9,"freight_value":8.01},{"order_id":"20db59f6705840a0ce5c76b77487ad03","order_item_id":2,"product_id":"9799f204443f39b914cb108eb13ef6e2","seller_id":"55dedd83e501d8248880557d9073cbfd","price":84.9,"freight_value":8.01},{"order_id":"21b9bb429b09c08b2ae81e3ed20e8d2f","order_item_id":1,"product_id":"e0bf01f7bf9a2581d5b670edf6252aaa","seller_id":"9dc79dd988ac42f4d56c340d7048420a","price":129.9,"freight_value":9.07},{"order_id":"21cb15950725534b614707f82846010e","order_item_id":1,"product_id":"114d1f71a8c0da5baa0894d00b9debb6","seller_id":"3be634553519fb6536a03e1358e9fdc7","price":20.2,"freight_value":7.4},{"order_id":"24ac51b02d01abde547c474a994d2aa4","order_item_id":1,"product_id":"ab1106e227a745836a0dc83b374e2575","seller_id":"cbd996ad3c1b7dc71fd0e5f5df9087e2","price":22.6,"freight_value":12.82}]"""

order_items_df = pd.read_json(StringIO(order_items_json))
order_items_df.to_csv('order_items.csv', index=False)
print(f"[OK] Created order_items.csv ({len(order_items_df)} rows)")

# Suppliers data (100 suppliers with product counts)
suppliers_json = """[{"supplier_id":"001cca7ae9ae17fb1caed9dfb1094831","city":"cariacica","state":"ES","product_count":11,"avg_price":104.937363915862},{"supplier_id":"002100f778ceb8431b7a1020ff7ab48f","city":"franca","state":"SP","product_count":24,"avg_price":22.4454541986639},{"supplier_id":"004c9cd9d87a3c30c522c48c4fc07416","city":"ibitinga","state":"SP","product_count":88,"avg_price":115.957117686552},{"supplier_id":"00ee68308b45bc5e2660cd833c3f81cc","city":"sao paulo","state":"SP","product_count":23,"avg_price":117.790697674419},{"supplier_id":"00fc707aaaad2d31347cf883cd2dfe10","city":"maringa","state":"PR","product_count":19,"avg_price":93.9622223465531},{"supplier_id":"013900e863eace745d3ec7614cab5b1a","city":"curitiba","state":"PR","product_count":19,"avg_price":62.2961537287785},{"supplier_id":"0176f73cc1195f367f7b32db1e5b3aa8","city":"ibitinga","state":"SP","product_count":18,"avg_price":121.361536661784},{"supplier_id":"01cf7e3d21494c41fb86034f2e714fa1","city":"francisco beltrao","state":"PR","product_count":21,"avg_price":145.214328595062},{"supplier_id":"01fd077212124329bac32490e8ef80d9","city":"ribeirao preto / sao paulo","state":"SP","product_count":12,"avg_price":30.974358974359},{"supplier_id":"01fdefa7697d26ad920e9e0346d4bd1b","city":"londrina","state":"PR","product_count":21,"avg_price":113.904046706571},{"supplier_id":"0241d4d5d36f10f80c644447315af0bd","city":"curitiba","state":"PR","product_count":56,"avg_price":127.632927251056},{"supplier_id":"02c988090b766852e088c69d7fb3b551","city":"americana","state":"SP","product_count":11,"avg_price":95.2147046257468},{"supplier_id":"02ecc2a19303f05e59ce133fd923fff7","city":"santo andre","state":"SP","product_count":17,"avg_price":219.341249148051},{"supplier_id":"02f623a8eb246f3c5f7c2f96462654e6","city":"botucatu","state":"SP","product_count":23,"avg_price":144.954545454545},{"supplier_id":"0417b067eeab773d2f7061a726dc477f","city":"sao bento do sul","state":"SC","product_count":11,"avg_price":143.013845590445},{"supplier_id":"04308b1ee57b6625f47df1d56f00eedf","city":"bombinhas","state":"SC","product_count":20,"avg_price":639.687254641918},{"supplier_id":"0432ead42b6c8a0bdf68154add917fdf","city":"maua","state":"SP","product_count":56,"avg_price":86.5788902282715},{"supplier_id":"048c2757535328e0d7dac690ad3c0aae","city":"franca","state":"SP","product_count":20,"avg_price":181.66234887815},{"supplier_id":"04aba03279157f6d4e0fe8ccaf21963c","city":"santo antonio de padua","state":"RJ","product_count":12,"avg_price":160.99374961853},{"supplier_id":"04e38a233f726ef161074ab1c9b0399a","city":"sao paulo","state":"SP","product_count":11,"avg_price":48.2928572382246}]"""

suppliers_df = pd.read_json(StringIO(suppliers_json))
suppliers_df.to_csv('suppliers.csv', index=False)
print(f"[OK] Created suppliers.csv ({len(suppliers_df)} rows)")

# Inventory data (100 inventory records with stock levels)
inventory_json = """[{"product_id":"3d5837f86205fe83f03fb5f7e4d5b9cf","warehouse_id":4,"stock_level":10,"reorder_point":3,"last_restocked":"2025-09-29","status":"In Stock"},{"product_id":"afeeea6271148ee1bb15173b8187c431","warehouse_id":2,"stock_level":63,"reorder_point":13,"last_restocked":"2025-09-25","status":"In Stock"},{"product_id":"dceb3f67aef3484498a7caa4ba50f484","warehouse_id":3,"stock_level":6,"reorder_point":2,"last_restocked":"2025-08-28","status":"In Stock"},{"product_id":"ecaaaccb5eb3102553f001d62db6389e","warehouse_id":4,"stock_level":5,"reorder_point":2,"last_restocked":"2025-10-13","status":"Low Stock"},{"product_id":"9048cbd294fe0c1a3ec8c8248bc2cadd","warehouse_id":2,"stock_level":12,"reorder_point":4,"last_restocked":"2025-10-11","status":"Low Stock"},{"product_id":"4464ecc5c8cd38eff5beae1484f80166","warehouse_id":1,"stock_level":9,"reorder_point":3,"last_restocked":"2025-09-30","status":"In Stock"},{"product_id":"6abd84909e8ed79ef808c16f90b91093","warehouse_id":3,"stock_level":16,"reorder_point":4,"last_restocked":"2025-09-14","status":"In Stock"},{"product_id":"82e4ad16521ca131d95e198d507db370","warehouse_id":3,"stock_level":50,"reorder_point":11,"last_restocked":"2025-10-10","status":"In Stock"},{"product_id":"58816ce2ec224ea03aff8abe045f8407","warehouse_id":2,"stock_level":6,"reorder_point":2,"last_restocked":"2025-08-28","status":"In Stock"},{"product_id":"0a4f9f421af66d2ea061fbb8883419f7","warehouse_id":1,"stock_level":21,"reorder_point":5,"last_restocked":"2025-10-03","status":"Low Stock"},{"product_id":"5eedf4c1aa6ce63c49b7e0c547bf0ad9","warehouse_id":3,"stock_level":9,"reorder_point":2,"last_restocked":"2025-09-01","status":"Low Stock"},{"product_id":"c9dbe2eec19a8093cb5ac57486531c18","warehouse_id":4,"stock_level":18,"reorder_point":4,"last_restocked":"2025-09-04","status":"In Stock"},{"product_id":"89321f94e35fc6d7903d36f74e351d40","warehouse_id":2,"stock_level":99,"reorder_point":30,"last_restocked":"2025-09-10","status":"Low Stock"},{"product_id":"67cee25aae565b8f1182ea8c37440103","warehouse_id":2,"stock_level":6,"reorder_point":2,"last_restocked":"2025-09-05","status":"In Stock"},{"product_id":"496f6bd86011e5a9ddea8dc96e802340","warehouse_id":4,"stock_level":7,"reorder_point":2,"last_restocked":"2025-10-09","status":"In Stock"},{"product_id":"2722b86640ddc24e1374c2df1ac2a230","warehouse_id":3,"stock_level":12,"reorder_point":3,"last_restocked":"2025-09-14","status":"In Stock"},{"product_id":"f497ba62f1d6b4f6a3a3266fa8623ad3","warehouse_id":2,"stock_level":19,"reorder_point":4,"last_restocked":"2025-08-30","status":"In Stock"},{"product_id":"a30ea5a9dbd95db5a674c4beadb4fb0d","warehouse_id":4,"stock_level":11,"reorder_point":3,"last_restocked":"2025-09-19","status":"In Stock"},{"product_id":"986700c98805af229ab7ad51b95fa356","warehouse_id":1,"stock_level":6,"reorder_point":2,"last_restocked":"2025-10-01","status":"Low Stock"},{"product_id":"060c17562f97e5bb60bc0dfa4dd5b3f2","warehouse_id":4,"stock_level":39,"reorder_point":10,"last_restocked":"2025-09-06","status":"Low Stock"}]"""

inventory_df = pd.read_json(StringIO(inventory_json))
inventory_df.to_csv('inventory.csv', index=False)
print(f"[OK] Created inventory.csv ({len(inventory_df)} rows)")

print("\n" + "=" * 60)
print("Dataset Export Complete!")
print("=" * 60)
print("\nAll 6 CSV files created successfully:")
print("  1. products.csv")
print("  2. orders.csv")
print("  3. order_items.csv")
print("  4. warehouses.csv (already exists)")
print("  5. suppliers.csv")
print("  6. inventory.csv")
print("\nThese datasets are ready for Week 10 Python lectures on:")
print("  - Data merging (pandas merge operations)")
print("  - Data reshaping (pivot, melt, stack, unstack)")
print("  - Data concatenation (vertical and horizontal)")
print("=" * 60)
